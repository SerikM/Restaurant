angular.module("common.core",["ngRoute","base64","ngUpload","ngAria","ngAnimate","ngMaterial","ngMessages"]),function(){"use strict";angular.module("common.ui",["ngMdIcons","ui.bootstrap","ui.bootstrap.tpls","ui.bootstrap.accordion","chieffancypants.loadingBar","ui.bootstrap.alert","ui.bootstrap.buttons","ui.bootstrap.carousel","ui.bootstrap.collapse","ui.bootstrap.dateparser","ui.bootstrap.datepicker","ui.bootstrap.dropdown","ui.bootstrap.modal","ui.bootstrap.pagination","ui.bootstrap.popover","ui.bootstrap.position","ui.bootstrap.progressbar","ui.bootstrap.rating","ui.bootstrap.stackedMap","ui.bootstrap.tabs","ui.bootstrap.timepicker","ui.bootstrap.tooltip","ui.bootstrap.typeahead","angularSpinner"])}(),function(){"use strict";angular.module("hm.reservation",["ui.bootstrap","ngMessages","ngNumberPicker"])}(),function(app){app.provider("reservationConfig",[function(){var config={getAvailableDatesAPIUrl:"/api/Booking/AvailableDates",getAvailableHoursAPIUrl:"/api/Booking/AvailableHours",reserveAPIUrl:"/api/Booking/Reserve",dateFormat:"yyyy-MM-dd",showConfirmationModal:!0,datepickerTemplate:"/js/store/reservation/datepicker.html",availableHoursTemplate:"/js/store/reservation/availableHours.html",noAvailableHoursTemplate:"/js/store/reservation/noAvailableHours.html",clientFormTemplate:"/js/store/reservation/clientForm.html",confirmationModalTemplate:"/js/store/reservation/confirmationModal.html",date:"Date",time:"Time",client:"Client",name:"Name",save:"Save",cancel:"Cancel",select:"Select",phone:"Phone",email:"Email",required:"This field is required",minLength:"Minimum length is 10 digits",maxLength:"Maximum length is 10 digits",invalidCharacters:"Not allowed characters",invalidPhone:"Invalid phone number",invalidEmail:"Invalid email address",invalidNumber:"Invalid number of guests",reserveText:"Reserve",confirmOK:"Yes, reserve",confirmCancel:"No, cancel",confirmTitle:"Confirm reservation",noAvailableHours:"There are not available hours for selected date, please select another date"};return{$get:function(){return config},set:function(values){angular.extend(config,values)}}}])}(angular.module("hm.reservation")),function(app){function reservationCtrl($scope,$filter,reservationAPIFactory,reservationConfig,reservationService){function isDateAvailable(date){return-1!==vm.availableDates.indexOf(date.toISOString().substr(0,10))}function getAvailableHours(date){var params={selectedDate:$filter("date")(date,vm.dateFormat)};reservationAPIFactory.getAvailableHours(params).then(function(){var status=vm.availableHoursStatus=reservationAPIFactory.status;"200"==status?vm.availableHours=reservationAPIFactory.availableHours:reservationService.onErrorGetAvailableHours(status,date)})}function onBeforeReserve(date,hour,userData){reservationService.onBeforeReserve(date,hour,userData).then(function(){reserve(date,hour,userData)},function(){})}function reserve(date,hour,userData){var params={selectedDate:$filter("date")(date,vm.dateFormat),selectedHour:hour,email:userData.email,phone:userData.phone,name:userData.name,quantity:userData.quantity};reservationAPIFactory.reserve(params).then(function(){var status=vm.reservationStatus=reservationAPIFactory.status;vm.reservationMessage="200"==status?"A confirmation email has been sent to "+userData.email:"Failed to process the booking. Please contact us on the phone number provided 0404 703 998."})}var vm=this;vm.selectedTab=0,vm.secondTabLocked=!0,vm.thirdTabLocked=!0,vm.selectedDate=new Date,vm.selectedHour={},vm.userData={},vm.dateFormat=reservationConfig.dateFormat,vm.datepickerTemplate=reservationConfig.datepickerTemplate,vm.availableHoursTemplate=reservationConfig.availableHoursTemplate,vm.noAvailableHoursTemplate=reservationConfig.noAvailableHoursTemplate,vm.clientFormTemplate=reservationConfig.clientFormTemplate,vm.date=reservationConfig.date,vm.time=reservationConfig.time,vm.client=reservationConfig.client,vm.name=reservationConfig.name,vm.save=reservationConfig.save,vm.cancel=reservationConfig.cancel,vm.select=reservationConfig.select,vm.phone=reservationConfig.phone,vm.email=reservationConfig.email,vm.required=reservationConfig.required,vm.minLength=reservationConfig.minLength,vm.maxLength=reservationConfig.maxLength,vm.invalidCharacters=reservationConfig.invalidCharacters,vm.invalidPhone=reservationConfig.invalidPhone,vm.invalidEmail=reservationConfig.invalidEmail,vm.invalidNumber=reservationConfig.invalidNumber,vm.reserveText=reservationConfig.reserveText,vm.confirmOK=reservationConfig.confirmOk,vm.confirmCancel=reservationConfig.confirmCancel,vm.confirmTitle=reservationConfig.confirmTitle,vm.confirmText=reservationConfig.confirmText,vm.noAvailableHours=reservationConfig.noAvailableHours,vm.reservationMessage="",vm.availableDates=[],reservationAPIFactory.getAvailableDates().then(function(){"200"==(vm.availableDatesStatus=reservationAPIFactory.status)&&(vm.availableDates=reservationAPIFactory.availableDates,vm.availableDates.length>0&&(vm.selectedDate=new Date(vm.availableDates[0])))}),$scope.input={num:0},$scope.getNumber=function(){alert("The number is: ["+$scope.input.num+"]")},$scope.onChanged=function(){console.log("The number is Changed ",$scope.input.num)},vm.datepickerOptions={dateDisabled:function(dateAndMode){var date=dateAndMode.date;return"day"===dateAndMode.mode&&!isDateAvailable(date)},showWeeks:!1},vm.onSelectDate=function(date){vm.selectedDate=date,vm.secondTabLocked=!1,vm.selectedTab=1,getAvailableHours(date)},vm.selectHour=function(hour){vm.thirdTabLocked=!1,vm.selectedHour=hour,vm.selectedTab=2},vm.reserve=function(date,hour,userData){onBeforeReserve(date,hour,userData)}}app.controller("ReservationCtrl",reservationCtrl),reservationCtrl.$inject=["$scope","$filter","reservationAPIFactory","reservationConfig","reservationService"]}(angular.module("hm.reservation")),angular.module("hm.reservation").directive("reservation",[function(){return{restrict:"E",scope:{datepickerOptions:"="},controller:"ReservationCtrl",controllerAs:"reservationCtrl",templateUrl:"/js/store/reservation/index.html"}}]),function(app){app.factory("reservationAPIFactory",["$http","reservationConfig",function($http,reservationConfig){function resetVariables(){reservationAPI.status="",reservationAPI.availableHours=""}var reservationAPI={};return reservationAPI.status="",reservationAPI.availableHours=[],reservationAPI.availableDates=[],reservationAPI.getAvailableDates=function(){return $http({method:"GET",url:reservationConfig.getAvailableDatesAPIUrl,responseType:"json"}).then(function(response){reservationAPI.status=response.status,reservationAPI.availableDates=response.data.availableDates},function(response){reservationAPI.errorManagement(response.status)})},reservationAPI.getAvailableHours=function(params){return $http({method:"GET",params:params,url:reservationConfig.getAvailableHoursAPIUrl,responseType:"json"}).then(function(response){reservationAPI.status=response.status,reservationAPI.availableHours=response.data.availableHours},function(response){reservationAPI.errorManagement(response.status)})},reservationAPI.reserve=function(params){return $http({method:"POST",data:params,url:reservationConfig.reserveAPIUrl,responseType:"json"}).then(function(response){reservationAPI.status=response.status},function(response){reservationAPI.errorManagement(response.status)})},reservationAPI.errorManagement=function(status){console.log("error code "+status),resetVariables(),reservationAPI.status="ERROR"},reservationAPI}])}(angular.module("hm.reservation")),function(app){app.service("reservationService",["$q","$filter","$uibModal","reservationConfig",function($q,$filter,$uibModal,reservationConfig){function openConfirmationModal(deferred,selectedDate,selectedHour,userData){$uibModal.open({templateUrl:reservationConfig.confirmationModalTemplate,size:"sm",controller:["selectedDate","selectedHour","userData",confirmationModalCtrl],controllerAs:"confirmationModalCtrl",resolve:{selectedDate:function(){return $filter("date")(selectedDate,reservationConfig.dateFormat)},selectedHour:function(){return selectedHour},userData:function(){return userData}}}).result.then(function(){deferred.resolve()},function(){deferred.reject()})}function confirmationModalCtrl(selectedDate,selectedHour,userData){var vm=this;vm.selectedDate=selectedDate,vm.selectedHour=selectedHour,vm.userData=userData,vm.confirmationParams={name:userData.name,selectedDate:selectedDate,selectedHour:selectedHour,quantity:userData.quantity}}this.onBeforeReserve=function(selectedDate,selectedHour,userData){var deferred=$q.defer();return reservationConfig.showConfirmationModal?openConfirmationModal(deferred,selectedDate,selectedHour,userData):deferred.resolve(),deferred.promise}}])}(angular.module("hm.reservation")),function(){function config($routeProvider,$locationProvider){$routeProvider.when("/",{templateUrl:"js/store/home/index.html",controller:"indexCtrl"}).when("/menu",{templateUrl:"js/store/menu/index.html",controller:"menuCtrl"}).when("/whatson",{templateUrl:"js/store/whatson/index.html",controller:"whatsonCtrl"}).when("/admin",{templateUrl:"js/store/admin/index.html",controller:"adminCtrl"}).when("/bookings",{templateUrl:"js/store/bookings/index.html",controller:"bookingsCtrl"}).when("/admin/carousel",{templateUrl:"js/store/admin/carousel/index.html",controller:"carouselAdminCtrl"}).when("/admin/whatson",{templateUrl:"js/store/admin/whatson/index.html",controller:"whatsonAdminCtrl"}).when("/admin/menu",{templateUrl:"js/store/admin/menu/index.html",controller:"menuAdminCtrl"}).otherwise({redirectTo:"/"}),$locationProvider.html5Mode({enabled:!0})}config.$inject=["$routeProvider","$locationProvider"],angular.module("store",["common.core","common.ui","hm.reservation"]).config(config)}(),function(app){"use strict";app.directive("topBar",function(){return{restrict:"E",link:function($scope,$element,$attrs){$scope.currentNavItem="home",$(function(){$(".mobile-navbar").mouseleave(function(){$(".navbar-collapse").hasClass("in")&&$("button.navbar-toggle").click()})})},replace:!0,templateUrl:"js/store/layouts/topBar.html"}}),app.config(function($mdThemingProvider){$mdThemingProvider.theme("docs-dark","default").primaryPalette("grey").warnPalette("red").accentPalette("blue").dark()})}(angular.module("common.ui")),function(app){"use strict";app.directive("leftBar",function(){return{restrict:"E",replace:!0,templateUrl:"js/store/layouts/leftBar.html"}})}(angular.module("common.ui")),function(app){"use strict";app.directive("bottomBar",function(){return{restrict:"E",replace:!0,templateUrl:"/js/store/layouts/bottomBar.html",link:function($scope,element,attrs){$scope.showAddressPopup=function(){var myLatLng={lat:-33.878,lng:151.215},mapCanvas=document.getElementById("map"),mapOptions={center:myLatLng,zoom:16,mapTypeId:google.maps.MapTypeId.ROADMAP},map=new google.maps.Map(mapCanvas,mapOptions);new google.maps.Marker({position:myLatLng,map:map,animation:google.maps.Animation.BOUNCE,title:"Rumpus Room"}),$("#mapModal").modal(),google.maps.event.addListenerOnce(map,"idle",function(){google.maps.event.trigger(map,"resize")})}}}})}(angular.module("common.ui")),function(app){"use strict";app.directive("owlCarousel",function(){return{restrict:"A",transclude:!1,link:function($scope,element,attributes){$scope.initCarousel=function(){$(element).owlCarousel({items:3,loop:!0,autoPlay:!0,dots:!0,margin:10,video:!0,center:!0})}}}})}(angular.module("common.ui")),function(app){"use strict";app.directive("owlCarouselItem",function(){return{restrict:"A",transclude:!1,link:function($scope,element,attributes){var elm="";elm=attributes.videourl?'<a class="owl-video" href="'+attributes.videourl+'" ></a >':'<img src="data:image/JPEG;base64,'+attributes.imagedata+'" />',$(element).append(elm),$scope.$last&&$scope.initCarousel()}}})}(angular.module("common.ui")),function(app){"use strict";app.directive("customOnChange",function(){return{restrict:"A",link:function(scope,element,attrs){var onChangeHandler=scope.$eval(attrs.customOnChange);element.on("change",onChangeHandler),element.on("$destroy",function(){element.off()})}}})}(angular.module("common.ui")),function(app){"use strict";function usSpinner($http,$rootScope){return{link:function(scope,elm,attrs){$rootScope.spinnerActive=!1,scope.isSpinning=function(){return $http.pendingRequests.length>0},scope.$watch(scope.isSpinning,function(spinning){$rootScope.spinnerActive=spinning,spinning?elm.removeClass("ng-hide"):elm.addClass("ng-hide")})}}}app.directive("usSpinner",usSpinner),usSpinner.$inject=["$http","$rootScope"]}(angular.module("common.ui")),function(app){"use strict";function rootCtrl($scope,$rootScope){$scope.userData={},$rootScope.repository={}}rootCtrl.$inject=["$scope","$rootScope"],app.controller("rootCtrl",rootCtrl)}(angular.module("store")),function(app){function indexCtrl($scope,apiService,notificationService){function slidesLoadCompleted(result){$scope.slides=result.data}function slidesLoadFailed(response){notificationService.displayError(response.data)}$scope.slides=[],window.scroll(0,0),apiService.get("/api/Home/GetSlides/",null,slidesLoadCompleted,slidesLoadFailed),$(function(){$scope.$scroller1=$("#goToCarousel").on("click",function(e){e.preventDefault();var id=$(this).data("target");$("html, body").animate({scrollTop:$("#"+id).offset().top-70},500,"linear")}),$scope.$scroller2=$("#back-top").on("click",function(i){i.preventDefault(),$("body, html").animate({scrollTop:0},800)}),$scope.$scrollerShower=$(window).scroll(function(){$(this).scrollTop()>300?$("#back-top").addClass("cd-is-visible"):$("#back-top").removeClass("cd-is-visible cd-fade-out"),$(this).scrollTop()>1200&&$("#back-top").addClass("cd-fade-out")})}),function(){var myLatLng={lat:-33.878,lng:151.215},mapCanvas=document.getElementById("mapMain"),mapOptions={center:myLatLng,zoom:16,mapTypeId:google.maps.MapTypeId.ROADMAP},map=new google.maps.Map(mapCanvas,mapOptions);new google.maps.Marker({position:myLatLng,map:map,animation:google.maps.Animation.BOUNCE,title:"Rumpus Room"});google.maps.event.addListenerOnce(map,"idle",function(){google.maps.event.trigger(map,"resize")})}()}app.controller("indexCtrl",indexCtrl),indexCtrl.$inject=["$scope","apiService","notificationService"]}(angular.module("store")),function(app){function whatsonCtrl($scope,apiService,notificationService){function loadEvents(){apiService.get("/api/Whatson/GetEvents/?num="+numToLoad+"&current="+$scope.current,null,eventsLoadCompleted,eventsLoadFailed)}function eventsLoadCompleted(result){result.data.length>0?($scope.events.push.apply($scope.events,result.data),$scope.current+=numToLoad):$scope.noMoreEventsToLoad=!0,$scope.isLoading=!1}function eventsLoadFailed(result){notificationService.displayError("failed to load events on the page"),$scope.isLoading=!1}$scope.events=[],$scope.current=0;var numToLoad=1;$scope.noMoreEventsToLoad=!1,$scope.isLoading=!1,window.scroll(0,0),$(function(){$scope.$eventsScroller=$("#goToEvents").on("click",function(e){e.preventDefault();var id=$(this).data("target");$("html, body").animate({scrollTop:$("#"+id).offset().top-70},500,"linear")})}),loadEvents(),$(function(){$(window).scroll(function(){1!=$scope.noMoreEventsToLoad&&1!=$scope.isLoading&&$(window).scrollTop()+$(window).height()>$(document).height()-100&&($scope.isLoading=!0,loadEvents())})})}app.controller("whatsonCtrl",whatsonCtrl),whatsonCtrl.$inject=["$scope","apiService","notificationService"]}(angular.module("store")),function(app){function menuCtrl($scope,$timeout,apiService,notificationService,$sce){function loadMenus(){apiService.get("/api/Menu/GetMenus?num="+numToLoad+"&currentMenu="+currentMenu+"&currentDish="+currentDish,null,menusLoadCompleted,menusLoadFailed)}function menusLoadCompleted(result){result.data&&0!==result.data.length?($scope.menus.length<=currentMenu?$scope.menus.push.apply($scope.menus,result.data):$scope.menus[currentMenu].ITEMS.push.apply($scope.menus[currentMenu].ITEMS,result.data[result.data.length-1].ITEMS),result.data[result.data.length-1].ITEMS.length<numToLoad?(currentMenu++,currentDish=0):currentDish+=numToLoad):noMoreItemsToLoad=!0,isLoading=!1}function menusLoadFailed(result){result&&result.data&&result.data.response?notificationService.displayError(result.data.response):notificationService.displayError("failed to load menu"),isLoading=!1}$scope.menus=[],$scope.downloadPdf=function(event,menu){event.preventDefault();for(var link=document.getElementById("down-link-"+menu.ID),byteString=atob(menu.PDF),ab=new ArrayBuffer(byteString.length),ia=new Uint8Array(ab),i=0;i<byteString.length;i++)ia[i]=byteString.charCodeAt(i);var file=new Blob([ab],{type:"application/pdf"}),fileURL=URL.createObjectURL(file);fileURL=$sce.trustAsResourceUrl(fileURL),link.href=fileURL,link.download="Menu.pdf",link.click()};var currentMenu=0,currentDish=0,numToLoad=3,isLoading=!1,noMoreItemsToLoad=!1;window.scroll(0,0),loadMenus(),$(function(){$scope.$scroller=$("#goToMenu").on("click",function(e){e.preventDefault();var id=$(this).data("target");$("html, body").animate({scrollTop:$("#"+id).offset().top-70},500,"linear")})}),$(function(){$(window).scroll(function(){!0!==noMoreItemsToLoad&&!0!==isLoading&&$(window).scrollTop()+$(window).height()>$(document).height()-200&&(isLoading=!0,loadMenus())})})}app.controller("menuCtrl",menuCtrl),menuCtrl.$inject=["$scope","$timeout","apiService","notificationService","$sce"]}(angular.module("store")),function(app){app.controller("bookingsCtrl",function(){window.scroll(0,0)})}(angular.module("store")),function(app){"use strict";function adminCtrl($scope,$timeout,apiService,notificationService){window.scroll(0,0)}app.controller("adminCtrl",adminCtrl),adminCtrl.$inject=["$scope","$timeout","apiService","notificationService"]}(angular.module("store")),function(app){"use strict";function whatsonAdminCtrl($scope,$timeout,apiService,notificationService){function deleteEventSuccess(response){reloadEvents($scope.current,0),notificationService.displaySuccess("successfully deleted event")}function deleteEventFail(response){notificationService.displayError("failed to delete event")}function deleteMediaSuccess(response){reloadEvents($scope.current,0),notificationService.displaySuccess("successfully deleted the media")}function deleteMediaFail(response){notificationService.displayError("failed to delete the media")}function setFancybox(){$(function(){$(".fancybox").fancybox({padding:0,autoScale:!0,transitionIn:"none",transitionOut:"none",type:"iframe",scrolling:"no",iframe:{preload:!1,scrolling:"no"}})})}function saveEventDetailsComplete(result){reloadEvents($scope.current+1,0),notificationService.displaySuccess(result.data.response)}function saveEventDetailsFail(error){notificationService.displayError(error.data.response)}function reloadEvents(numToLoad,current){apiService.get("/api/Admin/GetEvents/?num="+numToLoad+"&current="+current,null,eventsReloadCompleted,eventsReloadFailed)}function loadEvents(){apiService.get("/api/Admin/GetEvents?num="+numToLoad+"&current="+$scope.current,null,eventsLoadCompleted,eventsLoadFailed)}function eventsReloadCompleted(result){$scope.events=result.data,setFancybox()}function eventsReloadFailed(result){notificationService.displayError("failed to load events on the page")}function eventsLoadCompleted(result){result.data.length>0?($scope.events.push.apply($scope.events,result.data),$scope.current+=numToLoad):$scope.noMoreItemsToLoad=!0,$scope.isLoading=!1,setFancybox()}function eventsLoadFailed(result){notificationService.displayError("failed to load events on the page"),$scope.isLoading=!1}$scope.default64BasePlaceholder="iVBORw0KGgoAAAANSUhEUgAAARMAAAC4BAMAAAAyKxUSAAAAG1BMVEXMzMyWlpbFxcWqqqqcnJyjo6O+vr63t7exsbFF1ZRxAAAACXBIWXMAAA7EAAAOxAGVKw4bAAACeElEQVR4nO2Wv27bMBCHaf0fw5i2PFpJYXS02wLtKKbObgEZMlp5guoNrKQG/Ni944muEHsMl/b3DSRFEebnuxMlpQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAOCf594+7lWkHUvF7e3Fmoab/Onx1V19ulzwIURW6/KsEl1X0dxs6NYvNwikkujvvykaX4lvWkWG+i/v1xSskuvno7PMrrh+CN2cArMWq1Jl0ytLVhtWSRYUj6mTD6SyIY2udsN+p/LF5YqMEkPdhAQqw8tCJaih9Fc3PIooT0Xp51sKQDIbqfCiigaRqQKp2L38YaVSikg89/MxiXVydbdyUSHLjtzSchJI5bT0UWlph/T2aA5uPtJrNdQQjdnU7DPLOrtQKkxfc8tVk8y0NkuZnBd6OVKJrNH6wGkMqJLRDlIqaqJpv52bTWaVr2GnolqtOYULFVClc9UZ84NacRakQnLd1GOVnE+/g2rrgCqxfuCuYoN7Ot6S4WyxcrZ6lda8rMiSyjyYSmRdUFR3M0wUck17n5ewyqbmpBVTFU6ldZVCB8zwuFDpSN/7qhUVSzHKTereVbMgJpGkh3qfjswME3p9XkON3rNlSJV0+NncxeKN9stlJja9P+8kKqxi4u12a83PICrtw1hpQw9yKmXblon/806lOVAZuVuhaqU/SC/PTVcqf9w3de5z5lQ4RlUZUqX5cTqdXv0u9PVylBJhD1uPVBL9/CanXygVO3y3te73+ZtO0pJQ8XaLkQrfkndCKBU9qPRyrHxuZpKVvuQ34PKviiqejHzbhnwdAgAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAADwn/EHUbRImWMB2gQAAAAASUVORK5CYII=",$scope.saveEventDetails=function(event){var data={ID:event.ID,NAME:event.NAME,DESCRIPTION:event.DESCRIPTION};apiService.post("/api/Admin/SaveEvent",data,saveEventDetailsComplete,saveEventDetailsFail)},$scope.eventMediaUpdateCompleted=function(result){reloadEvents($scope.current+1,0),notificationService.displaySuccess("successfully updated event")},$scope.addNewImageBox=function(event){event.MEDIAS.push({ID:0,IMAGE:$scope.default64BasePlaceholder,URL:""})},$scope.addNewVideoBox=function(event){event.MEDIAS.push({ID:0,IMAGE:null,URL:"https://www.youtube.com/watch?v=z82L0EDmbms"})},$scope.addNewEventBox=function(){$scope.events.unshift({ID:0,NAME:"",DESCRIPTION:""})},$scope.events=[],$scope.current=0;var numToLoad=1;$scope.isLoading=!1,$scope.noMoreItemsToLoad=!1,$scope.selectFile=function(event){if(event&&event.target&&event.target.files&&event.target.files.length>0){var mediaId=event.target.attributes["data-target-media"].value,image=event.target.files[0],fileReader=new FileReader;fileReader.onload=function(fileLoadedEvent){for(var imageData=fileLoadedEvent.target.result,j=0;j<$scope.events.length;j++)for(var i=0;i<$scope.events[j].MEDIAS.length;i++)if($scope.events[j].MEDIAS[i].ID==mediaId){$scope.events[j].MEDIAS[i].IMAGE=imageData.split(",")[1],$scope.$apply();break}},fileReader.readAsDataURL(image)}},$scope.saveEventMedia=function(event){var mediaId=event.target.attributes["data-target-media"].value,uploadEl=angular.element(document.querySelector("#file-input-"+mediaId)),videoUrlInputEl=angular.element(document.querySelector("#video-url-input-"+mediaId));if(!(uploadEl&&uploadEl[0]&&uploadEl[0].value&&""!==uploadEl[0].value||videoUrlInputEl&&videoUrlInputEl[0]&&videoUrlInputEl[0].value&&""!==videoUrlInputEl[0].value))return event.preventDefault(),void notificationService.displayWarning("please select image to upload or provide video url")},$scope.deleteMedia=function(event){event.preventDefault();var deleteId=event.target.attributes["data-target-media"].value;apiService.post("/api/Admin/DeleteEventImage?id="+deleteId,null,deleteMediaSuccess,deleteMediaFail)},$scope.deleteEvent=function(event){event.preventDefault();var deleteId=event.target.attributes["data-target-event"].value;apiService.post("/api/Admin/DeleteEvent?id="+deleteId,null,deleteEventSuccess,deleteEventFail)},window.scroll(0,0),loadEvents(),$(function(){$(window).scroll(function(){1!=$scope.noMoreItemsToLoad&&1!=$scope.isLoading&&$(window).scrollTop()+$(window).height()>$(document).height()-100&&($scope.isLoading=!0,loadEvents())})})}app.controller("whatsonAdminCtrl",whatsonAdminCtrl),whatsonAdminCtrl.$inject=["$scope","$timeout","apiService","notificationService"]}(angular.module("store")),function(app){"use strict";function carouselAdminCtrl($scope,$timeout,apiService,notificationService){function deleteSlideSuccess(response){loadSlides(),notificationService.displaySuccess("successfully deleted the image")}function deleteSlideFail(response){notificationService.displayError("failed to delete the image")}function loadSlides(){apiService.get("/api/Home/GetSlides/",null,slidesLoadCompleted,slidesLoadFailed)}function slidesLoadCompleted(result){$scope.slides=result.data}function slidesLoadFailed(response){notificationService.displayError(response.data)}$scope.default64BasePlaceholder="iVBORw0KGgoAAAANSUhEUgAAARMAAAC4BAMAAAAyKxUSAAAAG1BMVEXMzMyWlpbFxcWqqqqcnJyjo6O+vr63t7exsbFF1ZRxAAAACXBIWXMAAA7EAAAOxAGVKw4bAAACeElEQVR4nO2Wv27bMBCHaf0fw5i2PFpJYXS02wLtKKbObgEZMlp5guoNrKQG/Ni944muEHsMl/b3DSRFEebnuxMlpQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAOCf594+7lWkHUvF7e3Fmoab/Onx1V19ulzwIURW6/KsEl1X0dxs6NYvNwikkujvvykaX4lvWkWG+i/v1xSskuvno7PMrrh+CN2cArMWq1Jl0ytLVhtWSRYUj6mTD6SyIY2udsN+p/LF5YqMEkPdhAQqw8tCJaih9Fc3PIooT0Xp51sKQDIbqfCiigaRqQKp2L38YaVSikg89/MxiXVydbdyUSHLjtzSchJI5bT0UWlph/T2aA5uPtJrNdQQjdnU7DPLOrtQKkxfc8tVk8y0NkuZnBd6OVKJrNH6wGkMqJLRDlIqaqJpv52bTWaVr2GnolqtOYULFVClc9UZ84NacRakQnLd1GOVnE+/g2rrgCqxfuCuYoN7Ot6S4WyxcrZ6lda8rMiSyjyYSmRdUFR3M0wUck17n5ewyqbmpBVTFU6ldZVCB8zwuFDpSN/7qhUVSzHKTereVbMgJpGkh3qfjswME3p9XkON3rNlSJV0+NncxeKN9stlJja9P+8kKqxi4u12a83PICrtw1hpQw9yKmXblon/806lOVAZuVuhaqU/SC/PTVcqf9w3de5z5lQ4RlUZUqX5cTqdXv0u9PVylBJhD1uPVBL9/CanXygVO3y3te73+ZtO0pJQ8XaLkQrfkndCKBU9qPRyrHxuZpKVvuQ34PKviiqejHzbhnwdAgAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAADwn/EHUbRImWMB2gQAAAAASUVORK5CYII=",$scope.slides=[],$scope.imageSaveCompleted=function(response){loadSlides(),notificationService.displaySuccess("successfully saved new image")},$scope.addNewSlideBox=function(){$scope.slides.push({ID:0,IMAGE:$scope.default64BasePlaceholder})},$scope.selectFile=function(event){if(event&&event.target&&event.target.files&&event.target.files.length>0){var slideId=event.target.attributes["data-target-slide"].value,image=event.target.files[0],fileReader=new FileReader;fileReader.onload=function(fileLoadedEvent){for(var imageData=fileLoadedEvent.target.result,i=0;i<$scope.slides.length;i++)if($scope.slides[i].ID==slideId){$scope.slides[i].IMAGE=imageData.split(",")[1],$scope.$apply();break}},fileReader.readAsDataURL(image)}},$scope.saveSlideImage=function(event){var imageUploadId=event.target.attributes["data-target-slide"].value,uploadElement=angular.element(document.querySelector("#file-input-"+imageUploadId));if(!uploadElement[0].value||""===uploadElement[0].value)return event.preventDefault(),void notificationService.displayWarning("please select image to upload")},$scope.deleteSlide=function(event){event.preventDefault();var deleteId=event.target.attributes["data-target-slide"].value;apiService.post("/api/Admin/DeleteSlide?id="+deleteId,null,deleteSlideSuccess,deleteSlideFail)},window.scroll(0,0),loadSlides()}app.controller("carouselAdminCtrl",carouselAdminCtrl),carouselAdminCtrl.$inject=["$scope","$timeout","apiService","notificationService"]}(angular.module("store")),function(app){"use strict";function menuAdminCtrl($scope,$timeout,apiService,notificationService){function deleteMenuSuccess(result){reloadMenus(),notificationService.displaySuccess(result.data.response)}function deleteMenuFail(result){notificationService.displayError(result.data.response)}function deleteDishSuccess(result){reloadMenus(),notificationService.displaySuccess(result.data.response)}function deleteDishFail(result){notificationService.displayError(result.data.response)}function loadMenus(){apiService.get("/api/Admin/GetMenus/?num="+numToLoad+"&currentMenu="+$scope.currentMenu+"&currentDish="+$scope.currentDish,null,menusLoadCompleted,menusLoadFailed)}function reloadMenus(){apiService.get("/api/Admin/GetMenusBulk?currentMenu="+$scope.currentMenu+"&currentDish="+$scope.currentDish,null,menusReloadCompleted,menusReloadFailed)}function menusReloadCompleted(result){$scope.menus=result.data}function menusReloadFailed(result){notificationService.displayError("failed to load menu items on the page")}function menusLoadCompleted(result){result.data&&0!==result.data.length?($scope.menus.length<=$scope.currentMenu?$scope.menus.push.apply($scope.menus,result.data):$scope.menus[$scope.currentMenu].ITEMS.push.apply($scope.menus[$scope.currentMenu].ITEMS,result.data[result.data.length-1].ITEMS),result.data[result.data.length-1].ITEMS.length<numToLoad?($scope.currentMenu++,$scope.currentDish=0):$scope.currentDish+=numToLoad):$scope.noMoreItemsToLoad=!0,isLoading=!1}function menusLoadFailed(result){result&&result.data&&result.data.response?notificationService.displayError(result.data.response):notificationService.displayError("failed to load menu"),isLoading=!1}$scope.default64BasePlaceholder="iVBORw0KGgoAAAANSUhEUgAAARMAAAC4BAMAAAAyKxUSAAAAG1BMVEXMzMyWlpbFxcWqqqqcnJyjo6O+vr63t7exsbFF1ZRxAAAACXBIWXMAAA7EAAAOxAGVKw4bAAACeElEQVR4nO2Wv27bMBCHaf0fw5i2PFpJYXS02wLtKKbObgEZMlp5guoNrKQG/Ni944muEHsMl/b3DSRFEebnuxMlpQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAOCf594+7lWkHUvF7e3Fmoab/Onx1V19ulzwIURW6/KsEl1X0dxs6NYvNwikkujvvykaX4lvWkWG+i/v1xSskuvno7PMrrh+CN2cArMWq1Jl0ytLVhtWSRYUj6mTD6SyIY2udsN+p/LF5YqMEkPdhAQqw8tCJaih9Fc3PIooT0Xp51sKQDIbqfCiigaRqQKp2L38YaVSikg89/MxiXVydbdyUSHLjtzSchJI5bT0UWlph/T2aA5uPtJrNdQQjdnU7DPLOrtQKkxfc8tVk8y0NkuZnBd6OVKJrNH6wGkMqJLRDlIqaqJpv52bTWaVr2GnolqtOYULFVClc9UZ84NacRakQnLd1GOVnE+/g2rrgCqxfuCuYoN7Ot6S4WyxcrZ6lda8rMiSyjyYSmRdUFR3M0wUck17n5ewyqbmpBVTFU6ldZVCB8zwuFDpSN/7qhUVSzHKTereVbMgJpGkh3qfjswME3p9XkON3rNlSJV0+NncxeKN9stlJja9P+8kKqxi4u12a83PICrtw1hpQw9yKmXblon/806lOVAZuVuhaqU/SC/PTVcqf9w3de5z5lQ4RlUZUqX5cTqdXv0u9PVylBJhD1uPVBL9/CanXygVO3y3te73+ZtO0pJQ8XaLkQrfkndCKBU9qPRyrHxuZpKVvuQ34PKviiqejHzbhnwdAgAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAADwn/EHUbRImWMB2gQAAAAASUVORK5CYII=",$scope.saveMenuDetails=function(event,menu){var uploadEl=angular.element(document.querySelector("#menu-banner-input-"+menu.ID));if(!uploadEl||!uploadEl[0]||!uploadEl[0].value||""===uploadEl[0].value)return event.preventDefault(),void notificationService.displayWarning("please select banner image")},$scope.menus=[],$scope.addNewMenuBox=function(){$scope.menus.unshift({ID:0,NAME:"",PDF:null,BANNER:$scope.default64BasePlaceholder})},$scope.addNewDishBox=function(menu){menu.ITEMS.push({ID:0,IMAGE:$scope.default64BasePlaceholder,NAME:"",DESCRIPTION:"",IS_SPECIAL:!1,PRICE:""})},$scope.saveDish=function(event,dish){var uploadEl=angular.element(document.querySelector("#dish-file-input-"+dish.ID));if(!uploadEl||!uploadEl[0]||!uploadEl[0].value||""===uploadEl[0].value)return event.preventDefault(),void notificationService.displayWarning("please select image to upload")},$scope.dishUpdateCompleted=function(){reloadMenus(),notificationService.displaySuccess("successfully updated dish")},$scope.selectDishImage=function(event){if(event.target.files.length>0){var dishId=event.target.attributes["data-target-item"].value,image=event.target.files[0],fileReader=new FileReader;fileReader.onload=function(fileLoadedEvent){for(var imageData=fileLoadedEvent.target.result,j=0;j<$scope.menus.length;j++)for(var i=0;i<$scope.menus[j].ITEMS.length;i++)if($scope.menus[j].ITEMS[i].ID==dishId){$scope.menus[j].ITEMS[i].IMAGE=imageData.split(",")[1],$scope.$apply();break}},fileReader.readAsDataURL(image)}},$scope.selectMenuBanner=function(event){if(event.target.files.length>0){var itemId=event.target.attributes["data-target-item"].value,image=event.target.files[0],fileReader=new FileReader;fileReader.onload=function(fileLoadedEvent){for(var imageData=fileLoadedEvent.target.result,j=0;j<$scope.menus.length;j++)if($scope.menus[j].ID==itemId){$scope.menus[j].BANNER=imageData.split(",")[1],$scope.$apply();break}},fileReader.readAsDataURL(image)}},$scope.selectMenuPdf=function(event){if(event.target.files.length>0){var itemId=event.target.attributes["data-target-item"].value,pdf=event.target.files[0];angular.element(document.querySelector("#pdf-name-display-"+itemId))[0].appendChild(document.createTextNode(pdf.name))}},$scope.deleteMenu=function(event,menu){event.preventDefault(),apiService.post("/api/Admin/DeleteMenu?id="+menu.ID,null,deleteMenuSuccess,deleteMenuFail)},$scope.deleteDish=function(event,dish){event.preventDefault(),apiService.post("/api/Admin/DeleteDish?id="+dish.ID,null,deleteDishSuccess,deleteDishFail)},$scope.saveMenuDetailsCompleted=function(){reloadMenus(),notificationService.displaySuccess("successfully updated menu")};var isLoading=!1;$scope.noMoreItemsToLoad=!1,$scope.currentMenu=0,$scope.currentDish=0;var numToLoad=4;window.scroll(0,0),loadMenus(),$(function(){$(window).scroll(function(){1!=$scope.noMoreItemsToLoad&&1!=isLoading&&$(window).scrollTop()+$(window).height()>$(document).height()-200&&(isLoading=!0,loadMenus())})})}app.controller("menuAdminCtrl",menuAdminCtrl),menuAdminCtrl.$inject=["$scope","$timeout","apiService","notificationService"]}(angular.module("store")),function(app){"use strict";function apiService($http,$location,notificationService,$rootScope){return{get:function(url,config,success,failure){return $http.get(url,config).then(function(result){success(result)},function(error){"401"==error.status?(notificationService.displayError("Auth required"),$rootScope.previousState=$location.Path(),$location.path("/login")):null!=failure&&failure(error)})},post:function(url,data,success,failure){return $http.post(url,data).then(function(result){success(result)},function(error){"401"==error.status?(notificationService.displayError("Auth required"),$rootScope.previousState=$location.Path(),$location.path("/login")):null!=failure&&failure(error)})}}}apiService.$inject=["$http","$location","notificationService","$rootScope"],app.factory("apiService",apiService)}(angular.module("common.core")),function(app){"use strict";app.factory("notificationService",function(){return toastr.options={positionClass:"toast-top-center",closeButton:!0,closeEasing:"swing",progressBar:!0,showDuration:300,hideDuration:1e3,timeOut:5e3,extendedTimeOut:1e3,showEasing:"swing",hideEasing:"linear",showMethod:"fadeIn",hideMethod:"fadeOut"},{displaySuccess:function(message){toastr.success(message)},displayError:function(error){Array.isArray(error)?error.forEach(function(err){toastr.error(err)}):toastr.error(error)},displayWarning:function(message){toastr.warning(message)},displayInfo:function(message){toastr.info(message)}}})}(angular.module("common.core"));